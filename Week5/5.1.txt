db.posts.aggregate([{$unwind:"$comments"},{$group:{_id:"$comments.author", commentsCount:{$sum:1}}},{$sort:{commentsCount:-1}},{$limit:1},{$project:{_id:0,author:"$_id",commentsCount:1}}])